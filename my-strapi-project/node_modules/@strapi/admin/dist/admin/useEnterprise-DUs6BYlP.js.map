{"version":3,"file":"useEnterprise-DUs6BYlP.js","sources":["../../admin/src/hooks/useEnterprise.ts"],"sourcesContent":["import * as React from 'react';\n\nimport { useCallbackRef } from '@strapi/design-system';\n\nfunction isEnterprise() {\n  return window.strapi.isEE;\n}\n\nexport interface UseEnterpriseOptions<TCEData, TEEData, TDefaultValue, TCombinedValue> {\n  defaultValue?: TDefaultValue;\n  combine?: (ceData: TCEData, eeData: TEEData) => TCombinedValue;\n  enabled?: boolean;\n}\n\ntype UseEnterpriseReturn<TCEData, TEEData, TDefaultValue, TCombinedValue> =\n  TDefaultValue extends null\n    ? TCEData | TEEData | TCombinedValue | null\n    : TCEData | TEEData | TCombinedValue | TDefaultValue;\n\nexport const useEnterprise = <\n  TCEData,\n  TEEData = TCEData,\n  TCombinedValue = TEEData,\n  TDefaultValue = TCEData,\n>(\n  ceData: TCEData,\n  eeCallback: () => Promise<TEEData>,\n  opts: UseEnterpriseOptions<TCEData, TEEData, TDefaultValue, TCombinedValue> = {}\n): UseEnterpriseReturn<TCEData, TEEData, TDefaultValue, TCombinedValue> => {\n  const { defaultValue = null, combine = (_ceData, eeData) => eeData, enabled = true } = opts;\n  const eeCallbackRef = useCallbackRef(eeCallback);\n  const combineCallbackRef = useCallbackRef(combine);\n\n  // We have to use a nested object here, because functions (e.g. Components)\n  // can not be stored as value directly\n  const [{ data }, setData] = React.useState<{\n    data: TCEData | TEEData | TDefaultValue | TCombinedValue | null;\n  }>({\n    data: isEnterprise() && enabled ? defaultValue : ceData,\n  });\n\n  React.useEffect(() => {\n    async function importEE() {\n      const eeData = await eeCallbackRef();\n      const combinedValue = combineCallbackRef(ceData, eeData);\n\n      setData({ data: combinedValue ? combinedValue : eeData });\n    }\n\n    if (isEnterprise() && enabled) {\n      importEE();\n    }\n  }, [ceData, eeCallbackRef, combineCallbackRef, enabled]);\n\n  // @ts-expect-error â€“ the hook type assertion works in practice. But seems to have issues here...\n  return data;\n};\n"],"names":["useCallbackRef","React"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAIA,SAAS,YAAe,GAAA;AACtB,EAAA,OAAO,OAAO,MAAO,CAAA,IAAA,CAAA;AACvB,CAAA;AAaO,MAAM,gBAAgB,CAM3B,MAAA,EACA,UACA,EAAA,IAAA,GAA8E,EACL,KAAA;AACzE,EAAM,MAAA,EAAE,YAAe,GAAA,IAAA,EAAM,OAAU,GAAA,CAAC,SAAS,MAAW,KAAA,MAAA,EAAQ,OAAU,GAAA,IAAA,EAAS,GAAA,IAAA,CAAA;AACvF,EAAM,MAAA,aAAA,GAAgBA,4BAAe,UAAU,CAAA,CAAA;AAC/C,EAAM,MAAA,kBAAA,GAAqBA,4BAAe,OAAO,CAAA,CAAA;AAIjD,EAAA,MAAM,CAAC,EAAE,IAAA,IAAQ,OAAO,CAAA,GAAIC,iBAAM,QAE/B,CAAA;AAAA,IACD,IAAM,EAAA,YAAA,EAAkB,IAAA,OAAA,GAAU,YAAe,GAAA,MAAA;AAAA,GAClD,CAAA,CAAA;AAED,EAAAA,gBAAA,CAAM,UAAU,MAAM;AACpB,IAAA,eAAe,QAAW,GAAA;AACxB,MAAM,MAAA,MAAA,GAAS,MAAM,aAAc,EAAA,CAAA;AACnC,MAAM,MAAA,aAAA,GAAgB,kBAAmB,CAAA,MAAA,EAAQ,MAAM,CAAA,CAAA;AAEvD,MAAA,OAAA,CAAQ,EAAE,IAAA,EAAM,aAAgB,GAAA,aAAA,GAAgB,QAAQ,CAAA,CAAA;AAAA,KAC1D;AAEA,IAAI,IAAA,YAAA,MAAkB,OAAS,EAAA;AAC7B,MAAS,QAAA,EAAA,CAAA;AAAA,KACX;AAAA,KACC,CAAC,MAAA,EAAQ,aAAe,EAAA,kBAAA,EAAoB,OAAO,CAAC,CAAA,CAAA;AAGvD,EAAO,OAAA,IAAA,CAAA;AACT;;;;"}